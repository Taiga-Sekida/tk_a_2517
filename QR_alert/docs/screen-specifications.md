# QRally Factory システム 画面仕様書

## システム概要

QRally Factoryは、工場における機械・ロボットの故障予測と監視を実現する次世代システムです。各画面は特定の機能を担い、現場スタッフから工場責任者まで、様々な役割のユーザーに対応したインターフェースを提供します。

---

## 1. メインダッシュボード (`/`)

### 実現内容
**工場全体の機械・ロボット管理の入り口となる統合管理画面**

#### 主要機能
- **QRコード生成・表示**: 各ロボット専用のQRコードを自動生成し、個別管理を実現
- **ロボット一覧表示**: 3種類のロボット（Alpha, Beta, Gamma）の状態を一覧で確認
- **直接アクセス**: QRコード読み取り不要でダッシュボードに直接アクセス可能
- **システム特徴説明**: 各機能の説明と使用方法を表示

#### 画面構成
```
┌─────────────────────────────────────────────────────────┐
│ 🏭 QRally Factory - Robot Management System            │
├─────────────────────────────────────────────────────────┤
│ Individual Robot QR Codes                              │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│ │Robot Alpha  │ │Robot Beta   │ │Robot Gamma  │        │
│ │[QR Code]    │ │[QR Code]    │ │[QR Code]    │        │
│ │[Dashboard]  │ │[Dashboard]  │ │[Dashboard]  │        │
│ └─────────────┘ └─────────────┘ └─────────────┘        │
├─────────────────────────────────────────────────────────┤
│ 🏭 QRally Factory 監視システム                         │
│ [🏭 工場監視システム] [🚨 工場責任者] [🔍 改良確認]      │
├─────────────────────────────────────────────────────────┤
│ 🔧 ロボット部位一覧                                     │
│ [頭部][左腕][右腕][胴体][左脚][右脚][ベース]            │
└─────────────────────────────────────────────────────────┘
```

#### 実現する価値
- **現場での即座なアクセス**: QRコードを読み取るだけで該当ロボットの詳細情報にアクセス
- **統合管理**: 複数のロボットを一つの画面で管理
- **直感的操作**: 専門知識がなくても簡単に操作可能

---

## 2. ロボット詳細ダッシュボード (`/robot-dashboard?id=ROBOT_XXX`)

### 実現内容
**個別ロボットのリアルタイム状態監視とAI分析結果の可視化**

#### 主要機能
- **3Dロボット可視化**: Three.jsによるリアルタイム3Dロボット表示
- **部位別状態表示**: 各部位（頭部、腕、胴体、脚、ベース）の個別状態を色分けで表示
- **リアルタイムデータ更新**: 3秒間隔でのセンサーデータ更新
- **AI分析結果表示**: 温度、振動、湿度、疲労の総合分析結果
- **アラート表示**: UDPアラートのリアルタイム表示
- **レポート生成**: 手動でのレポート生成機能

#### 画面構成
```
┌─────────────────────────────────────────────────────────┐
│ 🏭 QRally Factory Robot Dashboard: ROBOT_001           │
│ [← Back] [📊 レポート生成] [🔍 アラート機構] [🌡️ 温度履歴] [🤖 AI分析] │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────┐ ┌─────────────────────────────┐ │
│ │                     │ │ 🔧 Parts Status             │ │
│ │   3D Robot          │ │ ┌─────────────────────────┐ │ │
│ │   Visualization     │ │ │ 頭部    [NORMAL]        │ │ │
│ │                     │ │ │ 左腕    [WARNING]       │ │ │
│ │   [Status: NORMAL]  │ │ │ 右腕    [NORMAL]        │ │ │
│ │                     │ │ │ 胴体    [CRITICAL]      │ │ │
│ └─────────────────────┘ │ │ 左脚    [NORMAL]        │ │ │
│                         │ │ 右脚    [NORMAL]        │ │ │
│                         │ │ ベース  [NORMAL]        │ │ │
│                         │ └─────────────────────────┘ │ │
│                         │ 📈 Overall Statistics       │ │
│                         │ Total: 7 | Normal: 5        │ │
│                         │ Warning: 1 | Critical: 1    │ │
│                         └─────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ 🚨 UDP ALERTS (左下固定)                               │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [UDP ALERT] 胴体: CRITICAL - 温度上昇検知          │ │
│ │ 🤖 AI: 冷却システムの点検が必要です                │ │
│ │ 💡 冷却ファンの交換を推奨します                    │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

#### 実現する価値
- **直感的な状態把握**: 3D表示によりロボットの状態を視覚的に理解
- **リアルタイム監視**: 常に最新の状態を把握
- **AI支援**: 専門知識がなくてもAIが分析結果と推奨事項を提示
- **即座な対応**: 異常検知時にすぐに適切な対応が可能

---

## 3. 工場監視システム (`/factory-monitor`)

### 実現内容
**工場全体の自動監視とバックグラウンド監視システムの制御**

#### 主要機能
- **バックグラウンド監視制御**: 5秒間隔での自動監視の開始・停止
- **監視状態表示**: 現在の監視状況とレポート生成状況を表示
- **システムログ表示**: 監視システムの動作ログを確認
- **緊急停止機能**: 全ロボットの緊急停止機能

#### 画面構成
```
┌─────────────────────────────────────────────────────────┐
│ 🏭 QRally Factory 監視システム                         │
├─────────────────────────────────────────────────────────┤
│ 監視システム制御                                        │
│ [▶️ 監視開始] [⏹️ 監視停止] [📊 状態確認]              │
├─────────────────────────────────────────────────────────┤
│ 現在の状態                                              │
│ 監視状況: 🟢 アクティブ                                 │
│ 監視間隔: 5秒                                           │
│ 生成レポート数: 15件                                    │
├─────────────────────────────────────────────────────────┤
│ システムログ                                            │
│ [2024-01-15 14:30:15] EMERGENCY: ROBOT_001 - 2 critical parts
│ [2024-01-15 14:25:10] EMERGENCY: ROBOT_002 - 1 critical parts
│ [2024-01-15 14:20:05] EMERGENCY: ROBOT_003 - 3 critical parts
├─────────────────────────────────────────────────────────┤
│ 緊急制御                                                │
│ [🚨 全ロボット緊急停止] [📋 緊急レポート一覧]           │
└─────────────────────────────────────────────────────────┘
```

#### 実現する価値
- **24時間365日監視**: 人間では不可能な継続的な監視を実現
- **自動化**: 手動操作不要で自動的に異常を検知・対応
- **緊急対応**: 重大な異常発生時の即座な対応が可能

---

## 4. 工場責任者ダッシュボード (`/factory-manager`)

### 実現内容
**工場責任者向けの統合管理と緊急対応機能**

#### 主要機能
- **全ロボット状態一覧**: 工場内の全ロボットの状態を一覧表示
- **緊急アラート表示**: 重大な異常発生時の緊急アラート
- **レポート管理**: 生成されたレポートの一覧とダウンロード
- **緊急停止機能**: 個別・全体の緊急停止機能
- **統計情報**: 工場全体の稼働状況とメンテナンス履歴

#### 画面構成
```
┌─────────────────────────────────────────────────────────┐
│ 🚨 QRally Factory 責任者ダッシュボード                 │
├─────────────────────────────────────────────────────────┤
│ 緊急アラート                                            │
│ 🚨 CRITICAL: ROBOT_001 - 胴体で温度スパイク検知        │
│ ⚠️  WARNING: ROBOT_002 - 左腕で振動異常検知            │
├─────────────────────────────────────────────────────────┤
│ 全ロボット状態                                          │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│ │ROBOT_001    │ │ROBOT_002    │ │ROBOT_003    │        │
│ │🔴 CRITICAL  │ │🟡 WARNING   │ │🟢 NORMAL    │        │
│ │[緊急停止]   │ │[詳細確認]   │ │[詳細確認]   │        │
│ └─────────────┘ └─────────────┘ └─────────────┘        │
├─────────────────────────────────────────────────────────┤
│ レポート管理                                            │
│ emergency_report_ROBOT_001_2024-01-15.txt [📥 ダウンロード]
│ emergency_report_ROBOT_002_2024-01-15.txt [📥 ダウンロード]
│ critical_report_ROBOT_003_2024-01-15.txt [📥 ダウンロード]
├─────────────────────────────────────────────────────────┤
│ 緊急制御                                                │
│ [🚨 全ロボット緊急停止] [📊 工場統計] [📋 メンテナンス履歴] │
└─────────────────────────────────────────────────────────┘
```

#### 実現する価値
- **統合管理**: 工場全体の状況を一つの画面で把握
- **迅速な判断**: 緊急時の即座な判断と対応が可能
- **責任者の権限**: 工場責任者としての適切な権限と責任を明確化

---

## 5. 改良確認システム (`/improvement-verification`)

### 実現内容
**Physical AI × QRシステムの改良状況を定量的に評価・確認**

#### 主要機能
- **総合評価表示**: システム全体の評価スコア（95/100点）とステータス
- **機能別実装状況**: 各機能の実装状況を色分けで表示
- **詳細機能一覧**: AI診断、監視、ダッシュボード、レポート生成の詳細
- **技術仕様確認**: 使用技術とシステム構成の確認
- **推奨事項表示**: 今後の改善提案と推奨事項

#### 画面構成
```
┌─────────────────────────────────────────────────────────┐
│ 🔍 QRally Factory システム改良確認                     │
│ [← 戻る]                                                │
├─────────────────────────────────────────────────────────┤
│ 📊 総合評価                                             │
│ 95/100 優秀                                             │
│ QRally Factoryとして大幅な改良が実装されており、        │
│ 工場環境での実用的な故障予測・監視システムとして機能している│
├─────────────────────────────────────────────────────────┤
│ 🤖 AI診断エージェント ✅ 実装済み                      │
│ 実装機能:                                               │
│ • 温度パターン分析（徐々に上昇、急激なスパイク、間欠的高温）│
│ • 振動分析（高周波・低周波振動の検知）                  │
│ • 湿度分析（高湿度・結露リスクの検知）                  │
│ • 疲労分析（材料疲労・機械的摩耗の予測）                │
│ AI能力: [predictive_maintenance] [root_cause_analysis]  │
├─────────────────────────────────────────────────────────┤
│ 🏭 バックグラウンド監視 ✅ 実装済み                    │
│ 実装機能:                                               │
│ • 5秒間隔での自動監視                                  │
│ • Critical状況の即座検知                               │
│ • 緊急レポートの自動生成                                │
│ • 重複レポート防止機能（5分間隔）                       │
│ 監視間隔: 5秒 | レポート生成: 自動（異常検知時）        │
├─────────────────────────────────────────────────────────┤
│ 📊 リアルタイムダッシュボード ✅ 実装済み              │
│ 実装機能:                                               │
│ • 3Dロボット可視化（Three.js）                         │
│ • リアルタイムデータ更新（3秒間隔）                     │
│ • 部位別ステータス表示                                  │
│ • アラート機構の可視化                                  │
│ 更新頻度: 3秒 | 可視化: Three.js 3D                    │
├─────────────────────────────────────────────────────────┤
│ 📄 自動レポート生成 ✅ 実装済み                        │
│ 実装機能:                                               │
│ • Critical/緊急レポートの自動生成                       │
│ • 詳細なエラー分析                                      │
│ • AI分析結果の統合                                      │
│ • 対応手順の自動生成                                    │
│ レポートタイプ: CRITICAL, emergency | 自動保存: 有効    │
├─────────────────────────────────────────────────────────┤
│ 📱 QRコード連携 ✅ 実装済み                            │
│ 実装機能:                                               │
│ • QRコードによるロボット識別                            │
│ • QRコード生成機能                                      │
│ • QR読み取りによる詳細表示                              │
│ • Physical AIとの連携                                   │
│ QRライブラリ: qrcode | 連携: Physical AI × QR          │
├─────────────────────────────────────────────────────────┤
│ 🚀 システム全体の改良 ✅ 大幅改良済み                  │
│ 主要改良点:                                             │
│ • 観光向けQRallyから工場向けPhysical AI × QRシステムへの進化│
│ • AI診断エージェントによる高度な故障予測                │
│ • バックグラウンド監視による24時間自動監視              │
│ • リアルタイムダッシュボードによる直感的な状態把握      │
│ • 自動レポート生成による迅速な対応支援                  │
│ • QRコード連携による現場での即座なアクセス              │
│ 進化: 観光QRally → QRally Factory                      │
├─────────────────────────────────────────────────────────┤
│ 💡 今後の推奨事項                                      │
│ • 継続的な監視データの蓄積によるAI精度向上              │
│ • より多くのロボットタイプへの対応拡張                  │
│ • 予測精度の向上のための機械学習モデルの継続学習        │
└─────────────────────────────────────────────────────────┘
```

#### 実現する価値
- **定量的評価**: システムの改良状況を数値で評価（95/100点）
- **透明性**: 各機能の実装状況を明確に表示
- **継続改善**: 今後の改善方向性を明確化
- **品質保証**: システムの信頼性と品質を保証

---

## 6. アラート機構詳細パネル（モーダル）

### 実現内容
**アラートシステムの動作状況と機構の詳細表示**

#### 主要機能
- **機構情報表示**: アラート機構の状態、チェック頻度、最終チェック時刻
- **最近のアラート**: 発生したアラートの履歴と詳細情報
- **Docker時刻表示**: コンテナ内での正確な時刻情報

#### 実現する価値
- **透明性**: アラートシステムの動作状況を可視化
- **デバッグ支援**: 問題発生時の原因特定を支援
- **信頼性**: システムの安定動作を確認

---

## 7. 温度履歴パネル（モーダル）

### 実現内容
**温度スパイクの履歴と発熱ログの詳細表示**

#### 主要機能
- **温度スパイク履歴**: 過去の温度異常の記録と分析
- **発熱ログ**: 詳細な温度変化の記録
- **Docker時刻**: 正確な時刻情報での記録

#### 実現する価値
- **履歴分析**: 過去の異常パターンを分析
- **予測精度向上**: 温度変化の傾向を把握
- **メンテナンス計画**: 予防保全の計画立案を支援

---

## 8. AI分析パネル（モーダル）

### 実現内容
**AI診断エージェントの分析結果と推奨事項の詳細表示**

#### 主要機能
- **AIエージェント情報**: エージェント名、バージョン、分析時刻
- **総合推奨事項**: AIによる総合的な推奨事項
- **部位別AI分析**: 各部位の詳細なAI分析結果
- **信頼度表示**: AI分析の信頼度を数値で表示

#### 実現する価値
- **AI透明性**: AIの判断根拠を明確化
- **専門知識不要**: 複雑な分析結果を分かりやすく表示
- **信頼性**: AI分析の信頼度を数値で確認

---

## システム全体の実現価値

### 1. **現場スタッフ向け**
- QRコードによる簡単アクセス
- 直感的な3D表示
- 専門知識不要の操作

### 2. **工場責任者向け**
- 統合的な管理機能
- 緊急時の迅速な対応
- 全体的な状況把握

### 3. **システム管理者向け**
- 改良状況の定量的評価
- 継続的な改善支援
- 品質保証機能

### 4. **工場全体への価値**
- 24時間365日の自動監視
- AIによる故障予測
- 生産性向上とコスト削減
- 安全性の向上

このシステムにより、従来の定期点検では不可能だった継続的な監視とAIによる高度な故障予測を実現し、工場の生産性と安全性を大幅に向上させることができます。
